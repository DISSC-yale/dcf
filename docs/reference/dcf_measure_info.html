<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Make a measurement metadata file — dcf_measure_info • dcf</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a measurement metadata file — dcf_measure_info"><meta name="description" content="Make a measure_info.json file, or add measure entries to an existing one."><meta property="og:description" content="Make a measure_info.json file, or add measure entries to an existing one."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dcf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/standards.html">Standards</a></li>
<li class="nav-item"><a class="nav-link" href="../report">Report</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DISSC-yale/dcf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Make a measurement metadata file</h1>
      <small class="dont-index">Source: <a href="https://github.com/DISSC-yale/dcf/blob/HEAD/R/dcf_measure_info.R" class="external-link"><code>R/dcf_measure_info.R</code></a></small>
      <div class="d-none name"><code>dcf_measure_info.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Make a <code>measure_info.json</code> file, or add measure entries to an existing one.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dcf_measure_info</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  references <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  strict <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_empty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite_entry <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  render <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  write <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  open_after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Path to the <code>measure_info.json</code> file, existing or to be created.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Lists containing individual measure items. See the Measure Entries section.</p></dd>


<dt id="arg-info">info<a class="anchor" aria-label="anchor" href="#arg-info"></a></dt>
<dd><p>A list containing measurement information to be added.</p></dd>


<dt id="arg-references">references<a class="anchor" aria-label="anchor" href="#arg-references"></a></dt>
<dd><p>A list containing citation entries. See the Reference Entries section.</p></dd>


<dt id="arg-strict">strict<a class="anchor" aria-label="anchor" href="#arg-strict"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, will only allow recognized entries and values.</p></dd>


<dt id="arg-include-empty">include_empty<a class="anchor" aria-label="anchor" href="#arg-include-empty"></a></dt>
<dd><p>Logical; if <code>FALSE</code>, will omit entries that have not been provided.</p></dd>


<dt id="arg-overwrite-entry">overwrite_entry<a class="anchor" aria-label="anchor" href="#arg-overwrite-entry"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, will replace rather than add to an existing entry.</p></dd>


<dt id="arg-render">render<a class="anchor" aria-label="anchor" href="#arg-render"></a></dt>
<dd><p>Path to save a version of <code>path</code> to, with dynamic entries expanded. See the
Dynamic Entries section.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, will overwrite rather than add to an existing <code>path</code>.</p></dd>


<dt id="arg-write">write<a class="anchor" aria-label="anchor" href="#arg-write"></a></dt>
<dd><p>Logical; if <code>FALSE</code>, will not write the build or rendered measure info.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical; if <code>FALSE</code>, will not display status messages.</p></dd>


<dt id="arg-open-after">open_after<a class="anchor" aria-label="anchor" href="#arg-open-after"></a></dt>
<dd><p>Logical; if <code>FALSE</code>, will not open the measure file after writing/updating.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An invisible list containing measurement metadata (the rendered version if made).</p>
    </div>
    <div class="section level2">
    <h2 id="measure-entries">Measure Entries<a class="anchor" aria-label="anchor" href="#measure-entries"></a></h2>


<p>Measure entries are named by the unique variable name with any of these entries (if <code>strict</code>):</p><ul><li><p><strong><code>id</code></strong>: Unique identifier of the measure; same as the entry name.
    This is meant to correspond to the column name containing the measure in data files.
    It should be minimal in length while still being unique across all files within the project.
    It should only contain the characters <code>a-z</code>, <code>0-9</code>, or <code>_</code>.</p></li>
<li><p><strong><code>short_name</code></strong>: Shortest possible display name.</p></li>
<li><p><strong><code>long_name</code></strong>: Longer display name.</p></li>
<li><p><strong><code>category</code></strong>: Arbitrary category for the measure.</p></li>
<li><p><strong><code>short_description</code></strong>: Shortest possible description.</p></li>
<li><p><strong><code>long_description</code></strong>: Complete description. Either description can include
    TeX-style equations, enclosed in escaped square brackets (e.g.,
    <code>"The equation \\[a_{i} = b^\\frac{c}{d}\\] was used."</code>; or <code>$...$</code>,
    <code>\\(...\\)</code>, or <code>\\begin{math}...\\end{math}</code>). The final enclosing symbol must be
    followed by a space or the end of the string. These are pre-render to MathML with
    <code><a href="https://docs.ropensci.org/katex/reference/katex.html" class="external-link">katex_mathml</a></code>.</p></li>
<li><p><strong><code>statement</code></strong>: String with dynamic references to entity features
    (e.g., <code>"measure value = {value}"</code>). References can include:</p><ul><li><p><code>value</code>: Value of a currently displaying variable at a current time.</p></li>
<li><p><code>region_name</code>: Alias of <code>features.name</code>.</p></li>
<li><p><code>features.&lt;entry&gt;</code>: An entity feature, coming from <code>entity_info.json</code> or GeoJSON properties.
        All entities have at least <code>name</code> and <code>id</code> entries (e.g., <code>"{features.id}"</code>).</p></li>
<li><p><code>variables.&lt;entry&gt;</code>: A variable feature such as <code>name</code> which is the same as
        <code>id</code> (e.g., <code>"{variables.name}"</code>).</p></li>
<li><p><code>data.&lt;variable&gt;</code>: The value of another variable at a current time (e.g., <code>"{data.variable_a}"</code>).</p></li>
</ul></li>
<li><p><strong><code>measure_type</code></strong>: Type of the measure's value. Recognized types are displayed in a special way:</p><ul><li><p><code>year</code> or <code>integer</code> show as entered (usually as whole numbers). Other numeric
        types are rounded to show a set number of digits.</p></li>
<li><p><code>percent</code> shows as <code>{value}%</code>.</p></li>
<li><p><code>minutes</code> shows as <code>{value} minutes</code>.</p></li>
<li><p><code>dollar</code> shows as <code>${value}</code>.</p></li>
<li><p><code>internet speed</code> shows as <code>{value} Mbps</code>.</p></li>
</ul></li>
<li><p><strong><code>unit</code></strong>: Prefix or suffix associated with the measure's type, such as <code>%</code> for <code>percent</code>,
    or <code>Mbps</code> for <code>rate</code>.</p></li>
<li><p><strong><code>time_resolution</code></strong>: Temporal resolution of the variable, such as <code>year</code> or <code>week</code>.</p></li>
<li><p><strong><code>restrictions</code></strong>: A license or description of restrictions that may apply to the measure.</p></li>
<li><p><strong><code>sources</code></strong>: A list or list of list containing source information, including any of these entries:</p><ul><li><p><code>name</code>: Name of the source (such as an organization name).</p></li>
<li><p><code>url</code>: General URL of the source (such as an organization's website).</p></li>
<li><p><code>location</code>: More specific description of the source (such as a the name of a particular data product).</p></li>
<li><p><code>location_url</code>: More direct URL to the resource (such as a page listing data products).</p></li>
<li><p><code>date_accessed</code>: Date of retrieval (arbitrary format).</p></li>
</ul></li>
<li><p><strong><code>citations</code></strong>: A vector of reference ids (the names of <code>reference</code> entries; e.g., <code>c("ref1", "ref3")</code>).</p></li>
<li><p><strong><code>categories</code></strong>: A named list of categories, with any of the other measure entries, or a
    <code>default</code> entry giving a default category name. See the Dynamic Entries section.</p></li>
<li><p><strong><code>variants</code></strong>: A named list of variants, with any of the other measure entries, or a
    <code>default</code> entry giving a default variant name. See the Dynamic Entries section.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="dynamic-entries">Dynamic Entries<a class="anchor" aria-label="anchor" href="#dynamic-entries"></a></h2>


<p>You may have several closely related variables in a dataset, which share sections of metadata,
or have formulaic differences. In cases like this, the <code>categories</code> and/or <code>variants</code> entries
can be used along with dynamic notation to construct multiple entries from a single template.</p>
<p>Though functionally the same, <code>categories</code> might include broken-out subsets of some total
(such as race groups, as categories of a total population), whereas <code>variants</code> may be different
transformations of the same variable (such as raw counts versus percentages).</p>
<p>In dynamic entries, <code>{category}</code> or <code>{variant}</code> refers to entries in the <code>categories</code>
or <code>variants</code> lists. By default, these are replaced with the name of each entries in those lists
(e.g., <code>"variable_{category}"</code> where <code>categories = "a"</code> would become <code>"variable_a"</code>).
A <code>default</code> entry would change this behavior (e.g., with <code>categories = list(a = list(default = "b")</code>
that would become <code>"variable_b"</code>). Adding <code>.name</code> would force the original behavior (e.g.,
<code>"variable_{category.name}"</code> would be <code>"variable_a"</code>). A name of <code>"blank"</code> is treated as
an empty string.</p>
<p>When notation appears in a measure info entry, they will first default to a matching name in the <code>categories</code>
or <code>variants</code> list; for example, <code>short_name</code> in <code>list(short_name = "variable {category}")</code> with
<code>categories = list(a = list(short_name = "(category a)"))</code> would become <code>"variable (category a)"</code>.
To force this behavior, the entry name can be included in the notation (e.g.,
<code>"{category.short_name}"</code> would be <code>"variable (category a)"</code> in any entry).</p>
<p>Only string entries are processed dynamically – any list-like entries (such as
<code>source</code>, <code>citations</code>, or <code>layer</code>) appearing in
<code>categories</code> or <code>variants</code> entries will fully replace the base entry.</p>
<p>Dynamic entries can be kept dynamic when passed to a data site, but can be rendered for other uses,
where the rendered version will have each dynamic entry replaced with all unique combinations of
<code>categories</code> and <code>variants</code> entries, assuming both are used in the dynamic entry's name
(e.g., <code>"variable_{category}_{variant}"</code>). See Examples.</p>
    </div>
    <div class="section level2">
    <h2 id="reference-entries">Reference Entries<a class="anchor" aria-label="anchor" href="#reference-entries"></a></h2>


<p>Reference entries can be included in a <code>_references</code> entry, and should have names corresponding to
those included in any of the measures' <code>citation</code> entries. These can include any of these entries:</p><ul><li><p><strong><code>id</code></strong>: The reference id, same as the entry name.</p></li>
<li><p><strong><code>author</code></strong>: A list or list of lists specifying one or more authors. These can include
    entries for <code>given</code> and <code>family</code> names.</p></li>
<li><p><strong><code>year</code></strong>: Year of the publication.</p></li>
<li><p><strong><code>title</code></strong>: Title of the publication.</p></li>
<li><p><strong><code>journal</code></strong>: Journal in which the publication appears.</p></li>
<li><p><strong><code>volume</code></strong>: Volume number of the journal.</p></li>
<li><p><strong><code>page</code></strong>: Page number of the journal.</p></li>
<li><p><strong><code>doi</code></strong>: Digital Object Identifier, from which a link is made (<code>https://doi.org/{doi}</code>).</p></li>
<li><p><strong><code>version</code></strong>: Version number of software.</p></li>
<li><p><strong><code>url</code></strong>: Link to the publication, alternative to a DOI.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make an initial file</span></span></span>
<span class="r-in"><span><span class="fu">dcf_measure_info</span><span class="op">(</span><span class="va">path</span>, <span class="st">"measure_name"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="st">"measure_name"</span>,</span></span>
<span class="r-in"><span>  short_description <span class="op">=</span> <span class="st">"A measure."</span>,</span></span>
<span class="r-in"><span>  statement <span class="op">=</span> <span class="st">"This entity has {value} measure units."</span></span></span>
<span class="r-in"><span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add another measure to that</span></span></span>
<span class="r-in"><span><span class="va">measure_info</span> <span class="op">&lt;-</span> <span class="fu">dcf_measure_info</span><span class="op">(</span><span class="va">path</span>, <span class="st">"measure_two"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="st">"measure_two"</span>,</span></span>
<span class="r-in"><span>  short_description <span class="op">=</span> <span class="st">"Another measure."</span>,</span></span>
<span class="r-in"><span>  statement <span class="op">=</span> <span class="st">"This entity has {value} measure units."</span></span></span>
<span class="r-in"><span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">measure_info</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "measure_name" "measure_two" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add a dynamic measure, and make a rendered version</span></span></span>
<span class="r-in"><span><span class="va">measure_info_rendered</span> <span class="op">&lt;-</span> <span class="fu">dcf_measure_info</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">path</span>,</span></span>
<span class="r-in"><span>  <span class="st">"measure_{category}_{variant.name}"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    id <span class="op">=</span> <span class="st">"measure_{category}_{variant.name}"</span>,</span></span>
<span class="r-in"><span>    short_description <span class="op">=</span> <span class="st">"Another measure ({category}; {variant})."</span>,</span></span>
<span class="r-in"><span>    statement <span class="op">=</span> <span class="st">"This entity has {value} {category} {variant}s."</span>,</span></span>
<span class="r-in"><span>    categories <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    variants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>u1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>default <span class="op">=</span> <span class="st">"U1"</span><span class="op">)</span>, u2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>default <span class="op">=</span> <span class="st">"U2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  render <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">measure_info_rendered</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "measure_name" "measure_two"  "measure_a_u1" "measure_b_u1" "measure_a_u2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "measure_b_u2"</span>
<span class="r-in"><span><span class="va">measure_info_rendered</span><span class="op">[[</span><span class="st">"measure_a_u1"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">statement</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "This entity has {value} a U1s."</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://dissc.yale.edu/" class="external-link">Yale Data-Intensive Social Science Center</a>, Micah Iserman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

